<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Top Level Namespace
  
    &mdash; Documentation by YARD 0.9.34
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/custom.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo;
    
    
    <span class="title">Top Level Namespace</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Top Level Namespace
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
</div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span>
    
  
    
  
</p>







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__-instance_method" title="#GET / (instance method)">#<strong>GET /</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Route to handle the root page.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__admin_-instance_method" title="#GET /admin/ (instance method)">#<strong>GET /admin/</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Display the admin dashboard.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__error-instance_method" title="#GET /error (instance method)">#<strong>GET /error</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Route to handle the ‘/error’ page.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__login-instance_method" title="#GET /login (instance method)">#<strong>GET /login</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Route to handle the ‘/login’ page.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__register-instance_method" title="#GET /register (instance method)">#<strong>GET /register</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Route to handle the ‘/register’ page.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__rooms_-instance_method" title="#GET /rooms/ (instance method)">#<strong>GET /rooms/</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Display the list of rooms.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__rooms__id-instance_method" title="#GET /rooms/:id (instance method)">#<strong>GET /rooms/:id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>View a room.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__rooms__id_edit-instance_method" title="#GET /rooms/:id/edit (instance method)">#<strong>GET /rooms/:id/edit</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Edit a room.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__rooms_join-instance_method" title="#GET /rooms/join (instance method)">#<strong>GET /rooms/join</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Display the login form for joining a room.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__rooms_new-instance_method" title="#GET /rooms/new (instance method)">#<strong>GET /rooms/new</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Display the form for creating a new room.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__signout-instance_method" title="#GET /signout (instance method)">#<strong>GET /signout</strong>  &#x21d2; Redirect </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Route to handle the user sign out.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__tags_new-instance_method" title="#GET /tags/new (instance method)">#<strong>GET /tags/new</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Display the form for creating a new tag.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__users__id-instance_method" title="#GET /users/:id (instance method)">#<strong>GET /users/:id</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Route to handle viewing user profile by ID.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#GET__users__id_edit-instance_method" title="#GET /users/:id/edit (instance method)">#<strong>GET /users/:id/edit</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Edit user profile page.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#handle_error-instance_method" title="#handle_error (instance method)">#<strong>handle_error</strong>(error_message)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Registers an error message and redirects to the error page.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#POST__admin_nuke-instance_method" title="#POST /admin/nuke (instance method)">#<strong>POST /admin/nuke</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Delete all data and recreate the root user.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#POST__login-instance_method" title="#POST /login (instance method)">#<strong>POST /login</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Route to handle the user login form submission.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#POST__message-instance_method" title="#POST /message (instance method)">#<strong>POST /message</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a new message in a room.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#POST__message__id_delete-instance_method" title="#POST /message/:id/delete (instance method)">#<strong>POST /message/:id/delete</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Delete a message.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#POST__rooms-instance_method" title="#POST /rooms (instance method)">#<strong>POST /rooms</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a new room.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#POST__rooms__id_delete-instance_method" title="#POST /rooms/:id/delete (instance method)">#<strong>POST /rooms/:id/delete</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Delete a room.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#POST__rooms__id_update-instance_method" title="#POST /rooms/:id/update (instance method)">#<strong>POST /rooms/:id/update</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Update a room.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#POST__rooms_join-instance_method" title="#POST /rooms/join (instance method)">#<strong>POST /rooms/join</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Join a room with an invite code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#POST__tags-instance_method" title="#POST /tags (instance method)">#<strong>POST /tags</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a new tag.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#POST__users-instance_method" title="#POST /users (instance method)">#<strong>POST /users</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Route to handle the user registration form submission.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#POST__users__id_update-instance_method" title="#POST /users/:id/update (instance method)">#<strong>POST /users/:id/update</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Update user profile.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="GET__-instance_method">
  
    #<strong>GET /</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Route to handle the root page.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


113
114
115</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 113</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/login</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__admin_-instance_method">
  
    #<strong>GET /admin/</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Display the admin dashboard</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


513
514
515</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 513</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/admin/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:&quot;admin/index&quot;</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__error-instance_method">
  
    #<strong>GET /error</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Route to handle the ‘/error’ page.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


105
106
107
108
109</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 105</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:action</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:action</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_p'>p</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>previous action was: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:action</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:error</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__login-instance_method">
  
    #<strong>GET /login</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Route to handle the ‘/login’ page.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


123
124
125</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 123</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/login</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:login</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__register-instance_method">
  
    #<strong>GET /register</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Route to handle the ‘/register’ page.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 129</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/register</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:&quot;users/new&quot;</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__rooms_-instance_method">
  
    #<strong>GET /rooms/</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Display the list of rooms</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 281</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:user</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>
    <span class='id identifier rubyid_selected_tags'>selected_tags</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:tags</span><span class='rbracket'>]</span>
  
    <span class='kw'>if</span> <span class='id identifier rubyid_selected_tags'>selected_tags</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_selected_tags'>selected_tags</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
      <span class='id identifier rubyid_tag_ids'>tag_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_selected_tags'>selected_tags</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_i</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='ivar'>@rooms</span> <span class='op'>=</span> <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>
        SELECT r.id AS room_id, r.name AS room_name, u.username AS owner_username,
          (SELECT COUNT(DISTINCT user_id) FROM room_user_relation WHERE room_id = r.id) AS member_count,
          r.owner_id
        FROM room AS r
        JOIN user AS u ON u.id = r.owner_id
        JOIN room_user_relation AS rur ON rur.room_id = r.id
        JOIN room_tags_relation AS tr ON tr.room_id = r.id
        WHERE rur.user_id = ? AND tr.tag_id IN (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tag_ids'>tag_ids</span><span class='embexpr_end'>}</span><span class='tstring_content'>)
        GROUP BY r.id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='comment'># no tags selected, show all rooms
</span>      <span class='ivar'>@rooms</span> <span class='op'>=</span> <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>
        SELECT r.id AS room_id, r.name AS room_name, u.username AS owner_username,
          (SELECT COUNT(DISTINCT user_id) FROM room_user_relation WHERE room_id = r.id) AS member_count,
          r.owner_id
        FROM room AS r
        JOIN user AS u ON u.id = r.owner_id
        JOIN room_user_relation AS rur ON rur.room_id = r.id
        WHERE rur.user_id = ?
        GROUP BY r.id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  
    <span class='ivar'>@tags</span> <span class='op'>=</span> <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tags</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:&quot;rooms/index&quot;</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__rooms__id-instance_method">
  
    #<strong>GET /rooms/:id</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>View a room</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the ID of the room to display</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/User.html#member_of_room%3F-instance_method" title="Mer::User#member_of_room? (method)">Mer::User#member_of_room?</a></span></li>
    
      <li><span class='object_link'><a href="Mer/Room.html#load_existing-instance_method" title="Mer::Room#load_existing (method)">Mer::Room#load_existing</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 380</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/:id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='ivar'>@room_id</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_user_obj'>user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:user</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    
    <span class='kw'>if</span> <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_member_of_room?'>member_of_room?</span><span class='lparen'>(</span><span class='ivar'>@room_id</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_room_obj'>room_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Room.html" title="Mer::Room (class)">Room</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Room.html#initialize-instance_method" title="Mer::Room#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_room_obj'>room_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='ivar'>@room_id</span><span class='rparen'>)</span>
        <span class='ivar'>@messages</span> <span class='op'>=</span> <span class='id identifier rubyid_room_obj'>room_obj</span><span class='period'>.</span><span class='id identifier rubyid_get_messages'>get_messages</span>
        <span class='ivar'>@invite</span> <span class='op'>=</span> <span class='id identifier rubyid_room_obj'>room_obj</span><span class='period'>.</span><span class='id identifier rubyid_get_invite'>get_invite</span>
        <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:&quot;rooms/show&quot;</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorHandler.html" title="Mer::ErrorHandler (module)">ErrorHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_register'><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">register</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Not a member.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__rooms__id_edit-instance_method">
  
    #<strong>GET /rooms/:id/edit</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Edit a room</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the ID of the room to edit</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/User.html#member_of_room%3F-instance_method" title="Mer::User#member_of_room? (method)">Mer::User#member_of_room?</a></span></li>
    
      <li><span class='object_link'><a href="Mer/User.html#owner_of_room%3F-instance_method" title="Mer::User#owner_of_room? (method)">Mer::User#owner_of_room?</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


402
403
404
405
406
407
408
409
410
411
412
413
414</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 402</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/:id/edit</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>
    <span class='id identifier rubyid_user_obj'>user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:user</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='ivar'>@room_id</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_member_of_room?'>member_of_room?</span><span class='lparen'>(</span><span class='ivar'>@room_id</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_owner_of_room?'>owner_of_room?</span><span class='lparen'>(</span><span class='ivar'>@room_id</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:&quot;rooms/edit&quot;</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorHandler.html" title="Mer::ErrorHandler (module)">ErrorHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_register'><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">register</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You do not have permission.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__rooms_join-instance_method">
  
    #<strong>GET /rooms/join</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Display the login form for joining a room</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


327
328
329</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 327</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/join</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:&quot;rooms/login&quot;</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__rooms_new-instance_method">
  
    #<strong>GET /rooms/new</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Display the form for creating a new room</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


319
320
321
322
323</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 319</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/new</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>
    <span class='ivar'>@tags</span> <span class='op'>=</span> <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tags</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:&quot;rooms/new&quot;</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__signout-instance_method">
  
    #<strong>GET /signout</strong>  &#x21d2; <tt>Redirect</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Route to handle the user sign out.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Redirect</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Redirects to the root page.</p>
</div>
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


187
188
189
190</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 187</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/signout</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
    <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__tags_new-instance_method">
  
    #<strong>GET /tags/new</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Display the form for creating a new tag</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


544
545
546</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 544</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/tags/new</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:&quot;tags/new&quot;</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__users__id-instance_method">
  
    #<strong>GET /users/:id</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Route to handle viewing user profile by ID.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>:id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The user ID.</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">Mer::ErrorHandler#register</a></span></li>
    
      <li><span class='object_link'><a href="Mer/User.html#exists%3F-instance_method" title="Mer::User#exists? (method)">Mer::User#exists?</a></span></li>
    
      <li><span class='object_link'><a href="Mer/Authorization.html#admin%3F-instance_method" title="Mer::Authorization#admin? (method)">Mer::Authorization#admin?</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 204</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/users/:id</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>
    <span class='id identifier rubyid_user_id'>user_id</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>

    <span class='id identifier rubyid_requested_user_obj'>requested_user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_requested_user_obj'>requested_user_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='id identifier rubyid_user_id'>user_id</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_requested_user_obj'>requested_user_obj</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span>
        <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorHandler.html" title="Mer::ErrorHandler (module)">ErrorHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_register'><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">register</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>User doesn&#39;t exist.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_user_obj'>user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:user</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>

    <span class='ivar'>@same_user</span> <span class='op'>=</span> <span class='id identifier rubyid_requested_user_obj'>requested_user_obj</span><span class='period'>.</span><span class='id identifier rubyid_get_id'>get_id</span> <span class='op'>==</span> <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_get_id'>get_id</span>
    <span class='ivar'>@admin</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Authorization.html" title="Mer::Authorization (module)">Authorization</a></span></span><span class='period'>.</span><span class='id identifier rubyid_admin?'><span class='object_link'><a href="Mer/Authorization.html#admin%3F-instance_method" title="Mer::Authorization#admin? (method)">admin?</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>

    <span class='ivar'>@username</span> <span class='op'>=</span> <span class='id identifier rubyid_requested_user_obj'>requested_user_obj</span><span class='period'>.</span><span class='id identifier rubyid_get_username'>get_username</span>
    <span class='ivar'>@id</span> <span class='op'>=</span> <span class='id identifier rubyid_requested_user_obj'>requested_user_obj</span><span class='period'>.</span><span class='id identifier rubyid_get_id'>get_id</span>

    <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:&quot;users/index&quot;</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GET__users__id_edit-instance_method">
  
    #<strong>GET /users/:id/edit</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Edit user profile page</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the ID of the user to edit</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/User.html#load_existing-instance_method" title="Mer::User#load_existing (method)">Mer::User#load_existing</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 232</span>

<span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/users/:id/edit</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>

    <span class='ivar'>@user_id</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_requested_user_obj'>requested_user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_requested_user_obj'>requested_user_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='ivar'>@user_id</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_user_obj'>user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:user</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='ivar'>@user_id</span> <span class='op'>==</span> <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_get_id'>get_id</span>
        <span class='id identifier rubyid_slim'>slim</span><span class='lparen'>(</span><span class='symbol'>:&quot;users/edit&quot;</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorHandler.html" title="Mer::ErrorHandler (module)">ErrorHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_register'><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">register</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorMessage.html" title="Mer::ErrorMessage (module)">ErrorMessage</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorMessage.html#UNAUTHORIZED-constant" title="Mer::ErrorMessage::UNAUTHORIZED (constant)">UNAUTHORIZED</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="handle_error-instance_method">
  
    #<strong>handle_error</strong>(error_message)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Registers an error message and redirects to the error page.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>error_message</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The error message to be registered.</p>
</div>
      
    </li>
  
</ul>




</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25
26
27</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 23</span>

<span class='kw'>def</span> <span class='id identifier rubyid_handle_error'>handle_error</span><span class='lparen'>(</span><span class='id identifier rubyid_error_message'>error_message</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorHandler.html" title="Mer::ErrorHandler (module)">ErrorHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_register'><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">register</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='id identifier rubyid_error_message'>error_message</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_path_info'>path_info</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="POST__admin_nuke-instance_method">
  
    #<strong>POST /admin/nuke</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Delete all data and recreate the root user</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/Database.html#delete-instance_method" title="Mer::Database#delete (method)">Mer::Database#delete</a></span></li>
    
      <li><span class='object_link'><a href="Mer/Database.html#create_root-instance_method" title="Mer::Database#create_root (method)">Mer::Database#create_root</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


521
522
523
524
525
526
527
528
529
530
531
532
533
534
535</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 521</span>

<span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/admin/nuke</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='comment'># CHECK FOR ADMIN USER TYPE
</span>    <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>

    <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>room</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>room_user_relation</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>room_tags_relation</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>message</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tags</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    
    <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_create_root'>create_root</span>

    <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/admin/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="POST__login-instance_method">
  
    #<strong>POST /login</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Route to handle the user login form submission.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>:username</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The username.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>:password</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The password.</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">Mer::ErrorHandler#register</a></span></li>
    
      <li><span class='object_link'><a href="Mer/User.html#login-instance_method" title="Mer::User#login (method)">Mer::User#login</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167
168
169
170
171
172
173
174
175
176
177</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 165</span>

<span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/login</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_username'>username</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:username</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_user_obj'>user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='kw'>begin</span>
        <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_login'>login</span><span class='lparen'>(</span><span class='id identifier rubyid_username'>username</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
        <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="POST__message-instance_method">
  
    #<strong>POST /message</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a new message in a room</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>room_id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the ID of the room</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>content</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the content of the message</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/Message.html#create-instance_method" title="Mer::Message#create (method)">Mer::Message#create</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


460
461
462
463
464
465
466
467
468
469
470
471
472
473</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 460</span>

<span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/message</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_room_id'>room_id</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:room_id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_message_content'>message_content</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:content</span><span class='rbracket'>]</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_room_id'>room_id</span>
        <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>
        <span class='id identifier rubyid_message_obj'>message_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Message.html" title="Mer::Message (class)">Message</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Message.html#initialize-instance_method" title="Mer::Message#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_message_obj'>message_obj</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_message_content'>message_content</span><span class='comma'>,</span> <span class='id identifier rubyid_room_id'>room_id</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorHandler.html" title="Mer::ErrorHandler (module)">ErrorHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_register'><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">register</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>No room_id found.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_room_id'>room_id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="POST__message__id_delete-instance_method">
  
    #<strong>POST /message/:id/delete</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Delete a message</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the ID of the message to delete</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/User.html#owner_of_message%3F-instance_method" title="Mer::User#owner_of_message? (method)">Mer::User#owner_of_message?</a></span></li>
    
      <li><span class='object_link'><a href="Mer/User.html#owner_of_room%3F-instance_method" title="Mer::User#owner_of_room? (method)">Mer::User#owner_of_room?</a></span></li>
    
      <li>Mer::Message#delete</li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 487</span>

<span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/message/:id/delete</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_message_id'>message_id</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>

    <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_get_equal'>get_equal</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>message</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>*</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_message_id'>message_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_room'>room</span> <span class='op'>=</span> <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_get_equal'>get_equal</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>room</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>room_id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_user_obj'>user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:user</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_owner_of_message?'>owner_of_message?</span><span class='lparen'>(</span><span class='id identifier rubyid_message_id'>message_id</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_owner_of_room?'>owner_of_room?</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>room_id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>message</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_message_id'>message_id</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span> <span class='id identifier rubyid_back'>back</span>
    <span class='kw'>else</span>
        <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorHandler.html" title="Mer::ErrorHandler (module)">ErrorHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_register'><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">register</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorMessage.html" title="Mer::ErrorMessage (module)">ErrorMessage</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorMessage.html#UNAUTHORIZED-constant" title="Mer::ErrorMessage::UNAUTHORIZED (constant)">UNAUTHORIZED</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="POST__rooms-instance_method">
  
    #<strong>POST /rooms</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a new room</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the name of the room</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>tags</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the tags associated with the room</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/Room.html#register-instance_method" title="Mer::Room#register (method)">Mer::Room#register</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


336
337
338
339
340
341
342
343
344
345
346
347
348
349</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 336</span>

<span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_tags'>tags</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:tags</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_room_obj'>room_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Room.html" title="Mer::Room (class)">Room</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Room.html#initialize-instance_method" title="Mer::Room#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='kw'>begin</span>
        <span class='id identifier rubyid_room_obj'>room_obj</span><span class='period'>.</span><span class='id identifier rubyid_register'>register</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_tags'>tags</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
        <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="POST__rooms__id_delete-instance_method">
  
    #<strong>POST /rooms/:id/delete</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Delete a room</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the ID of the room to delete</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/User.html#owner_of_room%3F-instance_method" title="Mer::User#owner_of_room? (method)">Mer::User#owner_of_room?</a></span></li>
    
      <li>Mer::Room#delete</li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


446
447
448</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 446</span>

<span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/:id/delete</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='comment'># check permissions
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="POST__rooms__id_update-instance_method">
  
    #<strong>POST /rooms/:id/update</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Update a room</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the ID of the room to update</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the new name of the room</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/User.html#owner_of_room%3F-instance_method" title="Mer::User#owner_of_room? (method)">Mer::User#owner_of_room?</a></span></li>
    
      <li><span class='object_link'><a href="Mer/Room.html#load_existing-instance_method" title="Mer::Room#load_existing (method)">Mer::Room#load_existing</a></span></li>
    
      <li><span class='object_link'><a href="Mer/Room.html#update_name-instance_method" title="Mer::Room#update_name (method)">Mer::Room#update_name</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 423</span>

<span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/:id/update</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>
    <span class='id identifier rubyid_user_obj'>user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:user</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_room_id'>room_id</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  
    <span class='kw'>if</span> <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_owner_of_room?'>owner_of_room?</span><span class='lparen'>(</span><span class='id identifier rubyid_room_id'>room_id</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_new_name'>new_name</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_room_obj'>room_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Room.html" title="Mer::Room (class)">Room</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Room.html#initialize-instance_method" title="Mer::Room#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_room_obj'>room_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='id identifier rubyid_room_id'>room_id</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_room_obj'>room_obj</span><span class='period'>.</span><span class='id identifier rubyid_update_name'>update_name</span><span class='lparen'>(</span><span class='id identifier rubyid_new_name'>new_name</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/rooms/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_room_id'>room_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorHandler.html" title="Mer::ErrorHandler (module)">ErrorHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_register'><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">register</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>You do not have permission to update this room.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="POST__rooms_join-instance_method">
  
    #<strong>POST /rooms/join</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Join a room with an invite code</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>invite</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the invite code for joining the room</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/Room.html#login-instance_method" title="Mer::Room#login (method)">Mer::Room#login</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


355
356
357
358
359
360
361
362
363
364
365
366
367</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 355</span>

<span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/join</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_invite'>invite</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:invite</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_room_obj'>room_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Room.html" title="Mer::Room (class)">Room</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Room.html#initialize-instance_method" title="Mer::Room#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='kw'>begin</span>
        <span class='id identifier rubyid_room_obj'>room_obj</span><span class='period'>.</span><span class='id identifier rubyid_login'>login</span><span class='lparen'>(</span><span class='id identifier rubyid_invite'>invite</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
        <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UNABLE TO JOIN</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="POST__tags-instance_method">
  
    #<strong>POST /tags</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create a new tag</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>label</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the label of the tag</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/Tag.html#register-instance_method" title="Mer::Tag#register (method)">Mer::Tag#register</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


552
553
554
555
556
557
558
559
560
561
562
563</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 552</span>

<span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/tags</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>
    <span class='id identifier rubyid_tag_obj'>tag_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Tag.html" title="Mer::Tag (class)">Tag</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Tag.html#initialize-instance_method" title="Mer::Tag#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_label'>label</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:label</span><span class='rbracket'>]</span>
    <span class='kw'>begin</span>
        <span class='id identifier rubyid_tag_obj'>tag_obj</span><span class='period'>.</span><span class='id identifier rubyid_register'>register</span><span class='lparen'>(</span><span class='id identifier rubyid_label'>label</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
        <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="POST__users-instance_method">
  
    #<strong>POST /users</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Route to handle the user registration form submission.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>:username</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The username.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>:password</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The password.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>:password_confirm</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The password confirmation.</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">Mer::ErrorHandler#register</a></span></li>
    
      <li><span class='object_link'><a href="Mer/User.html#register-instance_method" title="Mer::User#register (method)">Mer::User#register</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 140</span>

<span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/users</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>    
    <span class='id identifier rubyid_username'>username</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:username</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_password_confirm'>password_confirm</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:password_confirm</span><span class='rbracket'>]</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_password'>password</span> <span class='op'>!=</span> <span class='id identifier rubyid_password_confirm'>password_confirm</span>
        <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorHandler.html" title="Mer::ErrorHandler (module)">ErrorHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_register'><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">register</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorMessage.html" title="Mer::ErrorMessage (module)">ErrorMessage</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorMessage.html#PASSWORD_DIFFERENT-constant" title="Mer::ErrorMessage::PASSWORD_DIFFERENT (constant)">PASSWORD_DIFFERENT</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_user_obj'>user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='kw'>begin</span>
        <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_register'>register</span><span class='lparen'>(</span><span class='id identifier rubyid_username'>username</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/UserType.html" title="Mer::UserType (module)">UserType</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/UserType.html#USER-constant" title="Mer::UserType::USER (constant)">USER</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/rooms/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>rescue</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="POST__users__id_update-instance_method">
  
    #<strong>POST /users/:id/update</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Update user profile</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the ID of the user to update</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Mer/User.html#load_existing-instance_method" title="Mer::User#load_existing (method)">Mer::User#load_existing</a></span></li>
    
      <li><span class='object_link'><a href="Mer/User.html#update_username-instance_method" title="Mer::User#update_username (method)">Mer::User#update_username</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app.rb', line 255</span>

<span class='id identifier rubyid_post'>post</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/users/:id/update</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> 
    <span class='id identifier rubyid_db'>db</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/Database.html" title="Mer::Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/Database.html#initialize-instance_method" title="Mer::Database#initialize (method)">new</a></span></span>

    <span class='ivar'>@user_id</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='id identifier rubyid_requested_user_obj'>requested_user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_requested_user_obj'>requested_user_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='ivar'>@user_id</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_user_obj'>user_obj</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/User.html" title="Mer::User (class)">User</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Mer/User.html#initialize-instance_method" title="Mer::User#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_load_existing'>load_existing</span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:user</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='ivar'>@user_id</span> <span class='op'>==</span> <span class='id identifier rubyid_user_obj'>user_obj</span><span class='period'>.</span><span class='id identifier rubyid_get_id'>get_id</span>
        <span class='id identifier rubyid_requested_user_obj'>requested_user_obj</span><span class='period'>.</span><span class='id identifier rubyid_update_username'>update_username</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:username</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorHandler.html" title="Mer::ErrorHandler (module)">ErrorHandler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_register'><span class='object_link'><a href="Mer/ErrorHandler.html#register-instance_method" title="Mer::ErrorHandler#register (method)">register</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="Mer.html" title="Mer (module)">Mer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorMessage.html" title="Mer::ErrorMessage (module)">ErrorMessage</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Mer/ErrorMessage.html#UNAUTHORIZED-constant" title="Mer::ErrorMessage::UNAUTHORIZED (constant)">UNAUTHORIZED</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/error</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu May 11 20:02:52 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.1.3).
</div>

    </div>
  </body>
</html>